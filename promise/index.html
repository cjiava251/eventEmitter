<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
</head>

<body>
    <h1>Учебный курс: <div id="nameOfCourse"></div>
    </h1>
    <h2 id="topic"></h2>
    <h3 id="question"></h3>
    <input type="radio" name="answers" value="ans1"><span id="answer1"></span><p></p>
    <input type="radio" name="answers" value="ans2"><span id="answer2"></span><p></p>
    <input type="radio" name="answers" value="ans3"><span id="answer3"></span><p></p>
    <input type="radio" name="answers" value="ans4"><span id="answer4"></span><p></p>
    <input type="button" id="button1" value="Ответить" onclick="buttonClick()">
    <input type="button" id="button2" value="Повторить" hidden onclick="retry()">



    <script>
        var data = {
            "educationCourse": {
                "nameOfCourse": "Universe",
                "topics": [
                    {
                        "topicName": "Solar System",
                        "questions": [
                            {
                                "textOfQuestion": "Quantity of planets",
                                "answers": [6, 7, 8, 9],
                                "correctAnswer": 3
                            },
                            {
                                "textOfQuestion": "Our natural satellite",
                                "answers": [
                                    'moon',
                                    'titan',
                                    'phoenix',
                                    'num'
                                ],
                                "correctAnswer": 1
                            },
                            {
                                "textOfQuestion": "Biggest planet in system",
                                "answers": [
                                    "earth",
                                    "jupiter",
                                    "saturn",
                                    "neptun"
                                ],
                                "correctAnswer": 2
                            }
                        ]
                    },
                    {
                        "topicName": "Galaxies",
                        "questions": [
                            {
                                "textOfQuestion": "Name of our galaxy",
                                "answers": [
                                    "milky way",
                                    "coffe break",
                                    "time to tea",
                                    "claster phoenix"
                                ],
                                "correctAnswer": 1
                            },
                            {
                                "textOfQuestion": "Nearest galaxy",
                                "answers": [
                                    "artemida",
                                    "claster phoenix",
                                    "andromeda",
                                    "stolpy sozidaniya"
                                ],
                                "correctAnswer": 3
                            },
                            {
                                "textOfQuestion": "What in center of galaxy",
                                "answers": [
                                    "orange soda",
                                    "red line",
                                    "lost bkb",
                                    "black hole"
                                ],
                                "correctAnswer": 4
                            },
                            {
                                "textOfQuestion": "Form of many galaxies",
                                "answers": [
                                    "pyramid",
                                    "spiral",
                                    "cube",
                                    "ball"
                                ],
                                "correctAnswer": 2
                            }
                        ]
                    },
                    {
                        "topicName": "Planet Earth",
                        "questions": [
                            {
                                "textOfQuestion": "How many seas on planet",
                                "answers": [
                                    "30",
                                    "40",
                                    "50",
                                    "bigger"
                                ],
                                "correctAnswer": 4
                            },
                            {
                                "textOfQuestion": "How many mainlands",
                                "answers": [
                                    "6",
                                    "7",
                                    "8",
                                    "9"
                                ],
                                "correctAnswer": 1
                            },
                            {
                                "textOfQuestion": "Biggest mainland",
                                "answers": [
                                    "north America",
                                    "Eurasia",
                                    "Australia",
                                    "south America"
                                ],
                                "correctAnswer": 2
                            },
                            {
                                "textOfQuestion": "Where is Heops pyramid?",
                                "answers": [
                                    "on Earth",
                                    "in air",
                                    "in Giza",
                                    "under water"
                                ],
                                "correctAnswer": 3
                            }
                        ]
                    }
                ]
            }
        };
        var radio = document.getElementsByName('answers');
        var buttonPressed = false;
        var correctAnswer;
        var rightAnswers = 0, wrongAnswers = 0;
        var i = 0; j = 0;
        document.getElementById('nameOfCourse').innerHTML = data.educationCourse.nameOfCourse;

        function retry() {
            i = 0; j = 0; rightAnswers=0; wrongAnswers=0;
            document.getElementById('topic').innerHTML = 'Тема ' + 1 + ": " + data.educationCourse.topics[0].topicName;
            document.getElementById('question').innerHTML = 'Вопрос №' + 1 + ": " + data.educationCourse.topics[0].questions[0].textOfQuestion;
            for (let k = 0; k < data.educationCourse.topics[0].questions[0].answers.length; k++)
                document.getElementById('answer' + (k + 1)).innerHTML = data.educationCourse.topics[0].questions[0].answers[k];
            correctAnswer = data.educationCourse.topics[0].questions[0].correctAnswer;
            document.getElementsByName('answers').forEach((element) => {
                element.hidden = false;
            });
            for (let c=0;c<4;c++) 
                document.getElementById('answer'+(c+1)).hidden = false;
            document.getElementById('button1').hidden = false;
            document.getElementById('button2').hidden = true;
        }
        function resultsOfTest() {
        if ((i == data.educationCourse.topics.length) && (j == 0)) {
                document.getElementById('topic').innerHTML = "Right answers: " + rightAnswers;
                document.getElementById('question').innerHTML = "Wrong answers: " + wrongAnswers;
                document.getElementsByName('answers').forEach((element) => {
                    element.hidden = true;
                });
                for (let c=0;c<4;c++) 
                    document.getElementById('answer'+(c+1)).hidden = true;
                document.getElementById('button1').hidden = true;
                document.getElementById('button2').hidden = false;
            }
        }

        function buttonClick() {
            getResult().then(
                correct => { alert(correct); },
                wrong => { alert(wrong); }
            );
            document.getElementsByName('answers').forEach((elem) => {
                elem.checked=false;
            });
            if (j == data.educationCourse.topics[i].questions.length - 1) {
                j = 0;
                i++;
            } else
                j++;
            resultsOfTest();    
            if (i != data.educationCourse.topics.length) {
                document.getElementById('topic').innerHTML = 'Тема ' + (i + 1) + ": " + data.educationCourse.topics[i].topicName;
                document.getElementById('question').innerHTML = 'Вопрос №' + (j + 1) + ": " + data.educationCourse.topics[i].questions[j].textOfQuestion;
                for (let k = 0; k < data.educationCourse.topics[0].questions[0].answers.length; k++)
                    document.getElementById('answer' + (k + 1)).innerHTML = data.educationCourse.topics[i].questions[j].answers[k];
                correctAnswer = data.educationCourse.topics[i].questions[j].correctAnswer;
            }
        }

        function getResult() {
            return new Promise((resolve, reject) => {
                if (((correctAnswer == 1) && (radio[0].checked)) || ((correctAnswer == 2) && (radio[1].checked)) || ((correctAnswer == 3) && (radio[2].checked)) || ((correctAnswer == 4) && (radio[3].checked))) {
                    resolve("Right!");
                    rightAnswers++;
                }
                else {
                    reject("Wrong!");
                    wrongAnswers++;
                }
            });
        }
        document.getElementById('topic').innerHTML = 'Тема ' + 1 + ": " + data.educationCourse.topics[0].topicName;
        document.getElementById('question').innerHTML = 'Вопрос №' + 1 + ": " + data.educationCourse.topics[0].questions[0].textOfQuestion;
        for (let k = 0; k < data.educationCourse.topics[0].questions[0].answers.length; k++)
            document.getElementById('answer' + (k + 1)).innerHTML = data.educationCourse.topics[0].questions[0].answers[k];
        correctAnswer = data.educationCourse.topics[0].questions[0].correctAnswer;
    </script>
</body>

</html>